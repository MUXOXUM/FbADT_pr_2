# Архитектура проекта

## Структура модулей

Все три сервиса разделены на логические модули для улучшения поддерживаемости и читаемости кода.

### User Service (`service_users/`)

```
service_users/
├── config/
│   ├── index.js          # Конфигурация (PORT, JWT_SECRET, etc.)
│   └── logger.js         # Настройка логгера pino
├── database/
│   └── users.js          # Работа с in-memory БД пользователей
├── middleware/
│   ├── auth.js           # Middleware для авторизации и проверки прав
│   └── errorHandler.js   # Обработка ошибок и 404
├── models/
│   └── validation.js     # Zod схемы валидации
├── routes/
│   ├── authRoutes.js     # Роуты для регистрации и входа
│   └── userRoutes.js     # Роуты для работы с пользователями
├── services/
│   ├── authService.js    # Бизнес-логика аутентификации
│   └── userService.js    # Бизнес-логика работы с пользователями
├── utils/
│   └── response.js       # Утилиты для формирования ответов
└── index.js              # Точка входа приложения
```

### Order Service (`service_orders/`)

```
service_orders/
├── config/
│   ├── index.js          # Конфигурация
│   └── logger.js         # Настройка логгера
├── database/
│   └── orders.js         # Работа с in-memory БД заказов
├── middleware/
│   ├── auth.js           # Middleware для авторизации
│   └── errorHandler.js   # Обработка ошибок
├── models/
│   ├── constants.js      # Константы (статусы заказов)
│   └── validation.js     # Zod схемы валидации
├── routes/
│   └── orderRoutes.js    # Роуты для работы с заказами
├── services/
│   ├── orderService.js   # Бизнес-логика заказов
│   └── userService.js    # Проверка существования пользователя
├── utils/
│   ├── events.js         # Доменные события
│   └── response.js       # Утилиты для ответов
└── index.js              # Точка входа
```

### API Gateway (`api_gateway/`)

```
api_gateway/
├── config/
│   ├── index.js          # Конфигурация
│   └── logger.js         # Настройка логгера
├── middleware/
│   ├── auth.js           # JWT валидация и публичные роуты
│   ├── errorHandler.js   # Обработка ошибок
│   ├── rateLimit.js      # Rate limiting
│   └── requestId.js      # X-Request-ID middleware
├── utils/
│   └── proxy.js          # Конфигурация прокси
└── index.js              # Точка входа
```

## Принципы организации

1. **Разделение ответственности**: Каждый модуль отвечает за свою область
2. **Переиспользование**: Общие утилиты вынесены в отдельные модули
3. **Тестируемость**: Модули легко тестировать изолированно
4. **Масштабируемость**: Легко добавлять новые функции в соответствующие модули

## Преимущества модульной структуры

- ✅ Улучшенная читаемость кода
- ✅ Легче находить и исправлять ошибки
- ✅ Проще добавлять новые функции
- ✅ Улучшенная тестируемость
- ✅ Лучшая организация кода для команды разработчиков

